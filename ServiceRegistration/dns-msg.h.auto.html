<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>dns-msg.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">dns-msg.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="dns-msg.h">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/* dns-msg.h
 *
 * Copyright (c) 2018 Apple Computer, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Lightweight framework for generating, sending, and unpacking DNS messages.
 * Definitions...
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__DNS_MSG_H</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__DNS_MSG_H</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">DNS_MAX_UDP_PAYLOAD</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_MAX_UDP_PAYLOAD</span> 1410
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_HEADER_SIZE</span>           12
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_DATA_SIZE</span>             (DNS_MAX_UDP_PAYLOAD - DNS_HEADER_SIZE)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_MAX_POINTER</span>           ((2 &lt;&lt; 14) - 1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_MAX_LABEL_SIZE</span>        63
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_MAX_NAME_SIZE</span>	      255
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DNS_MAX_NAME_SIZE_ESCAPED</span> 1009

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_wire dns_wire_t;
<span class="enscript-type">struct</span> dns_wire {
    uint16_t id;
    uint16_t bitfield;
    uint16_t qdcount;
    uint16_t ancount;
    uint16_t nscount;
    uint16_t arcount;
    uint8_t data[DNS_DATA_SIZE];
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_towire_state dns_towire_state_t;
<span class="enscript-type">struct</span> dns_towire_state {
 	dns_wire_t *NULLABLE message;
    uint8_t *NONNULL p;
    uint8_t *NONNULL lim;
    uint8_t *NULLABLE p_rdlength;
    uint8_t *NULLABLE p_opt;
    <span class="enscript-type">int</span> error;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_transaction dns_transaction_t;
<span class="enscript-type">struct</span> dns_transaction {
    dns_transaction_t *NULLABLE next;
    dns_towire_state_t towire;
    dns_wire_t *NULLABLE response;
    <span class="enscript-type">int</span> response_length;
    <span class="enscript-type">int</span> sock;
};    

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_name_pointer dns_name_pointer_t;
<span class="enscript-type">struct</span> dns_name_pointer {
    uint8_t *NONNULL message_start;
    uint8_t *NONNULL name_start;
    <span class="enscript-type">int</span> num_labels;
    <span class="enscript-type">int</span> length;
};

<span class="enscript-type">typedef</span> <span class="enscript-function-name">void</span> (*dns_response_callback_t)(dns_transaction_t *NONNULL txn);

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_label dns_label_t;
<span class="enscript-type">typedef</span> dns_label_t dns_name_t;
<span class="enscript-type">struct</span> dns_label {
    dns_label_t *NULLABLE next;
    uint8_t len;
    <span class="enscript-type">char</span> data[DNS_MAX_LABEL_SIZE];
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_txt_element dns_txt_element_t;
<span class="enscript-type">struct</span> dns_txt_element {
    dns_txt_element_t *NULLABLE next;
    uint8_t len;
    <span class="enscript-type">char</span> data[0];
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_unparsed dns_rdata_unparsed_t;
<span class="enscript-type">struct</span> dns_rdata_unparsed {
    uint8_t *NULLABLE data;
    uint16_t len;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_single_name dns_rdata_ptr_t;
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_single_name dns_rdata_cname_t;
<span class="enscript-type">struct</span> dns_rdata_single_name {
    dns_label_t *NONNULL name;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_a dns_rdata_a_t;
<span class="enscript-type">struct</span> dns_rdata_a {
    <span class="enscript-type">struct</span> in_addr *NONNULL addrs;
    <span class="enscript-type">int</span> num;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_aaaa dns_rdata_aaaa_t;
<span class="enscript-type">struct</span> dns_rdata_aaaa {
    <span class="enscript-type">struct</span> in6_addr *NONNULL addrs;
    <span class="enscript-type">int</span> num;
} aaaa;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_srv dns_rdata_srv_t;
<span class="enscript-type">struct</span> dns_rdata_srv {
    dns_label_t *NONNULL name;
    uint16_t priority;
    uint16_t weight;
    uint16_t port;
} srv;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_sig dns_rdata_sig_t;
<span class="enscript-type">struct</span> dns_rdata_sig {
    uint16_t type;
    uint8_t algorithm;
    uint8_t label;
    uint32_t rrttl;
    uint32_t expiry;
    uint32_t inception;
    uint16_t key_tag;
    dns_label_t *NONNULL signer;
    <span class="enscript-type">int</span> start;
    <span class="enscript-type">int</span> len;
    uint8_t *NONNULL signature;
} sig;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rdata_key dns_rdata_key_t;
<span class="enscript-type">struct</span> dns_rdata_key {
    uint16_t flags;
    uint8_t protocol;
    uint8_t algorithm;
    <span class="enscript-type">int</span> len;
    uint8_t *NONNULL key;
} key;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_rr dns_rr_t;
<span class="enscript-type">struct</span> dns_rr {
    dns_label_t *NONNULL name;
    uint16_t type;
    uint16_t qclass;
    uint32_t ttl;
    <span class="enscript-type">union</span> {
        dns_rdata_unparsed_t unparsed;
        dns_rdata_ptr_t ptr;
        dns_rdata_cname_t cname;
        dns_rdata_a_t a;
        dns_rdata_aaaa_t aaaa;
        dns_rdata_srv_t srv;
        dns_txt_element_t *NONNULL txt;
        dns_rdata_sig_t sig;
        dns_rdata_key_t key;
    } data;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_edns0 dns_edns0_t;
<span class="enscript-type">struct</span> dns_edns0 {
    dns_edns0_t *NULLABLE next;
    uint16_t length;
    uint8_t data[0];
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> dns_message dns_message_t;
<span class="enscript-type">struct</span> dns_message {
    dns_wire_t *NULLABLE wire;
    <span class="enscript-type">int</span> qdcount, ancount, nscount, arcount;
    dns_rr_t *NULLABLE questions;
    dns_rr_t *NULLABLE answers;
    dns_rr_t *NULLABLE authority;
    dns_rr_t *NULLABLE additional;
    dns_edns0_t *NULLABLE edns0;
};

<span class="enscript-comment">// Masks for bitfield data
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qr_mask</span>     0x8000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_mask</span> 0x7800
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_mask</span>  0x07f0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_mask</span>  0x000f

<span class="enscript-comment">// Shifts for bitfield data
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qr_shift</span>     15
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_shift</span> 11
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_shift</span>  0

<span class="enscript-comment">// Booleans
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_aa</span> 0x0400
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_tc</span> 0x0200
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_rd</span> 0x0100
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_ra</span> 0x0080
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_ad</span> 0x0020
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_flags_cd</span> 0x0010

<span class="enscript-comment">// Getters
</span>#<span class="enscript-reference">define</span> <span class="enscript-function-name">dns_qr_get</span>(w) ((ntohs((w)-&gt;bitfield) &amp; dns_qr_mask) &gt;&gt; dns_qr_shift)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">dns_opcode_get</span>(w) ((ntohs((w)-&gt;bitfield) &amp; dns_opcode_mask) &gt;&gt; dns_opcode_shift)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">dns_rcode_get</span>(w) ((ntohs((w)-&gt;bitfield) &amp; dns_rcode_mask) &gt;&gt; dns_rcode_shift)

<span class="enscript-comment">// Setters
</span>#<span class="enscript-reference">define</span> <span class="enscript-function-name">dns_qr_set</span>(w, value) ((w)-&gt;bitfield = htons(((ntohs((w)-&gt;bitfield) &amp; ~dns_qr_mask) | \
                                                     ((value) &lt;&lt; dns_qr_shift))))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">dns_opcode_set</span>(w, value) ((w)-&gt;bitfield = htons(((ntohs((w)-&gt;bitfield) &amp; ~dns_opcode_mask) | \
                                                         ((value) &lt;&lt; dns_opcode_shift))))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">dns_rcode_set</span>(w, value) ((w)-&gt;bitfield = htons(((ntohs((w)-&gt;bitfield) &amp; ~dns_rcode_mask) | \
                                                        ((value) &lt;&lt; dns_rcode_shift))))

<span class="enscript-comment">// Query/Response
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qr_query</span>           0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qr_response</span>        1

<span class="enscript-comment">// Opcodes
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_query</span>       0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_iquery</span>      1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_status</span>      2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_notify</span>      4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_update</span>      5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opcode_dso</span>         6

<span class="enscript-comment">// Response Codes
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_noerror</span>      0 // [RFC1035] No Error
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_formerr</span>      1 // [RFC1035] Format Error
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_servfail</span>     2 // [RFC1035] Server Failure
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_nxdomain</span>     3 // [RFC1035] Non-Existent Domain
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_notimp</span>       4 // [RFC1035] Not Implemented
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_refused</span>      5 // [RFC1035] Query Refused
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_yxdomain</span>     6 // [RFC2136][RFC6672] Name Exists when it should not
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_yxrrset</span>      7 // [RFC2136] RR Set Exists when it should not
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_nxrrset</span>      8 // [RFC2136] RR Set that should exist does not
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_notauth</span>      9 // [RFC2136] Server Not Authoritative for zone, or [RFC2845] Not Authorized
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_notzone</span>     10 // [RFC2136] Name not contained in zone
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_dsotypeni</span>   11 // [RFCTBD draft-ietf-dnsop-session-signal] DSO-Type Not Implemented
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badvers</span>     16 // [RFC6891] Bad OPT Version, or [RFC2845] TSIG Signature Failure
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badkey</span>      17 // [RFC2845] Key not recognized
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badtime</span>     18 // [RFC2845] Signature out of time window
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badmode</span>     19 // [RFC2930] Bad TKEY Mode
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badname</span>     20 // [RFC2930] Duplicate key name
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badalg</span>      21 // [RFC2930] Algorithm not supported
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badtrunc</span>    22 // [RFC4635] Bad Truncation
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rcode_badcookie</span>   23 // [RFC7873] Bad/missing Server Cookie

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qclass_in</span>          1 // [RFC1035] Internet (IN)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qclass_chaos</span>       3 // [D. Moon, <span class="enscript-string">&quot;Chaosnet&quot;</span>] Chaosnet (MIT)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qclass_hesiod</span>      4 // [MIT Project Athena Technical Plan] Hesiod service
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qclass_none</span>      254 // [RFC2136] NONE (delete, or not in use)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_qclass_any</span>       255 // [RFC1035] ANY (wildcard)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_a</span>           1 // [RFC1035] a host address
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_ns</span>          2 // [RFC1035] an authoritative name server
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_md</span>          3 // [RFC1035] a mail destination (OBSOLETE - use MX)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_mf</span>          4 // [RFC1035] a mail forwarder (OBSOLETE - use MX)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_cname</span>       5 // [RFC1035] the canonical name for an alias
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_soa</span>         6 // [RFC1035] marks the start of a zone of authority
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_mb</span>          7 // [RFC1035] a mailbox domain name (EXPERIMENTAL)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_mg</span>          8 // [RFC1035] a mail group member (EXPERIMENTAL)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_mr</span>          9 // [RFC1035] a mail rename domain name (EXPERIMENTAL)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_null</span>       10 // [RFC1035]	 a null RR (EXPERIMENTAL)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_wks</span>        11 // [RFC1035]	 a well known service description
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_ptr</span>        12 // [RFC1035]	 a domain name pointer
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_hinfo</span>      13 // [RFC1035]	 host information
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_minfo</span>      14 // [RFC1035]	 mailbox or mail list information
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_mx</span>         15 // [RFC1035]	 mail exchange
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_txt</span>        16 // [RFC1035] text strings
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_rp</span>         17 // [RFC1183] for Responsible Person
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_afsdb</span>      18 // [RFC1183,RFC5864] for AFS Data Base location
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_x25</span>        19 // [RFC1183] for X.25 PSDN address
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_isdn</span>       20 // [RFC1183] for ISDN address
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_rt</span>         21 // [RFC1183] for Route Through
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nsap</span>       22 // [RFC1706] for NSAP address, NSAP style A record
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nsap_ptr</span>   23 // [RFC1348,RFC1637,RFC1706] for domain name pointer, NSAP style
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_sig</span>        24 // [RFC4034,RFC3755,RFC2535,RFC2536,RFC2537,RFC2931,RFC3110,RFC3008]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_key</span>        25 // [RFC4034,RFC3755,RFC2535,RFC2536,RFC2537,RFC2539,RFC3008,RFC3110]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_px</span>         26 // [RFC2163] X.400 mail mapping information
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_gpos</span>       27 // [RFC1712] Geographical Position
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_aaaa</span>       28 // [RFC3596] IP6 Address
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_loc</span>        29 // [RFC1876] Location Information
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nxt</span>        30 // [RFC3755] [RFC2535] Next Domain (OBSOLETE)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_eid</span>        31 // [<a href="http://ana-3.lcs.mit.edu/~jnc/nimrod/dns.txt">http://ana-3.lcs.mit.edu/~jnc/nimrod/dns.txt</a>] Endpoint Identifier
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nimloc</span>     32 // [<a href="http://ana-3.lcs.mit.edu/~jnc/nimrod/dns.txt">http://ana-3.lcs.mit.edu/~jnc/nimrod/dns.txt</a>] Nimrod Locator
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_srv</span>        33 // [RFC2782] Server Selection
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_atma</span>       34 // [<span class="enscript-string">&quot;ATM Name System, V2.0&quot;</span>] ATM Address
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_naptr</span>      35 // [RFC2915] [RFC2168] [RFC3403] Naming Authority Pointer
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_kx</span>         36 // [RFC2230] Key Exchanger
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_cert</span>       37 // [RFC4398] CERT
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_a6</span>         38 // [RFC3226] [RFC2874] [RFC6563]	 A6 (OBSOLETE - use AAAA)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_dname</span>      39 // [RFC6672]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_sink</span>       40 // [<a href="http://tools.ietf.org/html/draft-eastlake-kitchen-sink">http://tools.ietf.org/html/draft-eastlake-kitchen-sink</a>]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_opt</span>        41 // [RFC6891] [RFC3225]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_apl</span>        42 // [RFC3123]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_ds</span>         43 // [RFC4034] [RFC3658] Delegation Signer
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_sshfp</span>      44 // [RFC4255] SSH Key Fingerprint
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_ipseckey</span>   45 // [RFC4025]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_rrsig</span>      46 // [RFC4034] [RFC3755]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nsec</span>       47 // [RFC4034] [RFC3755]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_dnskey</span>     48 // [RFC4034] [RFC3755]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_dhcid</span>      49 // [RFC4701] DHCID
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nsec3</span>      50 // [RFC5155] NSEC3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nsec3param</span> 51 // [RFC5155] NSEC3PARAM
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_tlsa</span>       52 // [RFC6698] TLSA
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_smimea</span>     53 // [RFC8162] S/MIME cert association
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_hip</span>        55 // Host Identity Protocol
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_ninfo</span>      56 // [Jim_Reid] NINFO/ninfo-completed-template
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_rkey</span>       57 // [Jim_Reid] RKEY/rkey-completed-template
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_talink</span>     58 // [Wouter_Wijngaards] Trust Anchor LINK
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_cds</span>        59 // [RFC7344] Child DS
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_cdnskey</span>    60 // [RFC7344]	DNSKEY(s) the Child wants reflected in DS
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_openpgpkey</span> 61 // [RFC7929]	OpenPGP Key
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_csync</span>      62 // [RFC7477] Child-To-Parent Synchronization
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_spf</span>        99 // [RFC7208]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_uinfo</span>     100 // [IANA-Reserved]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_uid</span>       101 // [IANA-Reserved]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_gid</span>       102 // [IANA-Reserved]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_unspec</span>    103 // [IANA-Reserved]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_nid</span>       104 // [RFC6742]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_l32</span>       105 // [RFC6742]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_l64</span>       106 // [RFC6742]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_lp</span>        107 // [RFC6742]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_eui48</span>     108 // an EUI-48 address [RFC7043]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_eui64</span>     109 // an EUI-64 address [RFC7043]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_tkey</span>      249 // Transaction Key	[RFC2930]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_tsig</span>      250 // Transaction Signature [RFC2845]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_ixfr</span>      251 // incremental transfer	[RFC1995]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_axfr</span>      252 // transfer of an entire zone [RFC1035][RFC5936]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_mailb</span>     253 // mailbox-related RRs (MB, MG or MR) [RFC1035]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_maila</span>     254 // mail agent RRs (OBSOLETE - see MX) [RFC1035]		
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_any</span>       255 // A request for some or all records the server has available
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_uri</span>       256 // URI	[RFC7553]	URI/uri-completed-template
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_caa</span>       257 // Certification Authority Restriction [RFC6844]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_avc</span>       258 // Application Visibility and Control [Wolfgang_Riedel]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_rrtype_doa</span>       259 // Digital Object Architecture [draft-durand-doa-over-dns]

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_llq</span>            1 // On-hold [<a href="http://files.dns-sd.org/draft-sekar-dns-llq.txt">http://files.dns-sd.org/draft-sekar-dns-llq.txt</a>]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_update_lease</span>   2 // On-hold	[<a href="http://files.dns-sd.org/draft-sekar-dns-ul.txt">http://files.dns-sd.org/draft-sekar-dns-ul.txt</a>]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_nsid</span>           3 // [RFC5001]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_owner</span>          4 // [draft-cheshire-edns0-owner-option]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_dau</span>            5 // [RFC6975]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_dhu</span>            6 // [RFC6975]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_n3u</span>            7 // [RFC6975]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_client_subnet</span>  8 // [RFC7871]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_expire</span>         9 // [RFC7314]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_cookie</span>        10 // [RFC7873]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_keepalive</span>     11 // [RFC7828]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_padding</span>       12 // [RFC7830]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_chain</span>         13 // [RFC7901]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">dns_opt_key_tag</span>       14 // [RFC8145]

<span class="enscript-comment">// towire.c:
</span>
uint16_t <span class="enscript-function-name">srp_random16</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_name_to_wire</span>(dns_name_pointer_t *NULLABLE r_pointer,
                      dns_towire_state_t *NONNULL txn,
                      <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL name);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_full_name_to_wire</span>(dns_name_pointer_t *NULLABLE r_pointer,
                           dns_towire_state_t *NONNULL txn,
                           <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL name);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_pointer_to_wire</span>(dns_name_pointer_t *NULLABLE r_pointer,
                         dns_towire_state_t *NONNULL txn,
                         dns_name_pointer_t *NONNULL pointer);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_u8_to_wire</span>(dns_towire_state_t *NONNULL txn,
                    uint8_t val);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_u16_to_wire</span>(dns_towire_state_t *NONNULL txn,
                      uint16_t val);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_u32_to_wire</span>(dns_towire_state_t *NONNULL txn,
                      uint32_t val);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_ttl_to_wire</span>(dns_towire_state_t *NONNULL txn,
                     int32_t val);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rdlength_begin</span>(dns_towire_state_t *NONNULL txn);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rdlength_end</span>(dns_towire_state_t *NONNULL txn);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rdata_a_to_wire</span>(dns_towire_state_t *NONNULL txn,
                         <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL ip_address);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rdata_aaaa_to_wire</span>(dns_towire_state_t *NONNULL txn,
                            <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL ip_address);
uint16_t <span class="enscript-function-name">dns_rdata_key_to_wire</span>(dns_towire_state_t *NONNULL txn,
                               <span class="enscript-type">unsigned</span> key_type,
                               <span class="enscript-type">unsigned</span> name_type,
                               <span class="enscript-type">unsigned</span> signatory,
                               srp_key_t *NONNULL key);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rdata_txt_to_wire</span>(dns_towire_state_t *NONNULL txn,
                           <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL txt_record);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rdata_raw_data_to_wire</span>(dns_towire_state_t *NONNULL txn, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *NONNULL raw_data, size_t length);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_edns0_header_to_wire</span>(dns_towire_state_t *NONNULL txn,
                              <span class="enscript-type">int</span> mtu,
                              <span class="enscript-type">int</span> xrcode,
                              <span class="enscript-type">int</span> version,
                              <span class="enscript-type">int</span> DO);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_edns0_option_begin</span>(dns_towire_state_t *NONNULL txn);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_edns0_option_end</span>(dns_towire_state_t *NONNULL txn);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_sig0_signature_to_wire</span>(dns_towire_state_t *NONNULL txn,
                                srp_key_t *NONNULL key, uint16_t key_tag,
                                dns_name_pointer_t *NONNULL signer,
                                <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL signer_fqdn);
<span class="enscript-type">int</span> <span class="enscript-function-name">dns_send_to_server</span>(dns_transaction_t *NONNULL txn,
                       <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL anycast_address, uint16_t port,
                       dns_response_callback_t NONNULL callback);

<span class="enscript-comment">// fromwire.c:
</span>dns_label_t *NULLABLE <span class="enscript-function-name">dns_label_parse</span>(<span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> mlen, <span class="enscript-type">unsigned</span> *NONNULL offp);
bool <span class="enscript-function-name">dns_opt_parse</span>(dns_edns0_t *NONNULL *NULLABLE ret, dns_rr_t *NONNULL rrset);
bool <span class="enscript-function-name">dns_name_parse</span>(dns_label_t *NONNULL *NULLABLE ret, <span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> len,
                    <span class="enscript-type">unsigned</span> *NONNULL offp, <span class="enscript-type">unsigned</span> base);
bool <span class="enscript-function-name">dns_u8_parse</span>(<span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> len, <span class="enscript-type">unsigned</span> *NONNULL offp, uint8_t *NONNULL ret);
bool <span class="enscript-function-name">dns_u16_parse</span>(<span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> len, <span class="enscript-type">unsigned</span> *NONNULL offp, uint16_t *NONNULL ret);
bool <span class="enscript-function-name">dns_u32_parse</span>(<span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> len, <span class="enscript-type">unsigned</span> *NONNULL offp, uint32_t *NONNULL ret);
bool <span class="enscript-function-name">dns_rdata_parse_data</span>(dns_rr_t *NONNULL rr, <span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> *NONNULL offp,
                          <span class="enscript-type">unsigned</span> target, <span class="enscript-type">unsigned</span> rdlen, <span class="enscript-type">unsigned</span> rrstart);
bool <span class="enscript-function-name">dns_rr_parse</span>(dns_rr_t *NONNULL rrset,
                  <span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> len, <span class="enscript-type">unsigned</span> *NONNULL offp, bool rrdata_permitted);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_name_free</span>(dns_label_t *NONNULL name);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_rrdata_free</span>(dns_rr_t *NONNULL rr);
<span class="enscript-type">void</span> <span class="enscript-function-name">dns_message_free</span>(dns_message_t *NONNULL message);
bool <span class="enscript-function-name">dns_rdata_parse_data</span>(dns_rr_t *NONNULL rr, <span class="enscript-type">const</span> uint8_t *NONNULL buf, <span class="enscript-type">unsigned</span> *NONNULL offp,
                          <span class="enscript-type">unsigned</span> target, <span class="enscript-type">unsigned</span> rdlen, <span class="enscript-type">unsigned</span> rrstart);
bool <span class="enscript-function-name">dns_wire_parse</span>(dns_message_t *NONNULL *NULLABLE ret, dns_wire_t *NONNULL message, <span class="enscript-type">unsigned</span> len);
bool <span class="enscript-function-name">dns_names_equal</span>(dns_label_t *NONNULL name1, dns_label_t *NONNULL name2);
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL <span class="enscript-function-name">dns_name_print</span>(dns_name_t *NONNULL name, <span class="enscript-type">char</span> *NONNULL buf, <span class="enscript-type">int</span> bufmax);
bool <span class="enscript-function-name">dns_names_equal_text</span>(dns_label_t *NONNULL name1, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *NONNULL name2);
size_t <span class="enscript-function-name">dns_name_wire_length</span>(dns_label_t *NONNULL name);
size_t <span class="enscript-function-name">dns_name_to_wire_canonical</span>(uint8_t *NONNULL buf, size_t max, dns_label_t *NONNULL name);
#<span class="enscript-reference">endif</span> // <span class="enscript-variable-name">_DNS_MSG_H</span>

<span class="enscript-comment">// Local Variables:
</span><span class="enscript-comment">// mode: C
</span><span class="enscript-comment">// tab-width: 4
</span><span class="enscript-comment">// c-file-style: &quot;bsd&quot;
</span><span class="enscript-comment">// c-basic-offset: 4
</span><span class="enscript-comment">// fill-column: 108
</span><span class="enscript-comment">// indent-tabs-mode: nil
</span><span class="enscript-comment">// End:
</span></pre>
<hr />
</body></html>